{
  "kind": "build_request",
  "title": "Add per-investor session buffer for last 6 transaction hashes with read-only endpoint",
  "projectName": "Crowd-AI-Fund",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Add an in-memory session buffer for each logged-in INVESTOR that stores exactly the last 6 txn_hash values for that investor's current session, scoped per user session and not global",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-5"
        ],
        "quotes": [
          "Add an in-memory session buffer for each logged-in INVESTOR that stores exactly the last 6 txn_hash values for that investor's current session",
          "Scope this buffer per user session, not global"
        ]
      },
      "acceptanceCriteria": [
        "Each investor has their own session-scoped buffer",
        "Buffer stores exactly up to 6 txn_hash values",
        "Buffer is isolated per user session, not shared globally"
      ]
    },
    {
      "id": "REQ-2",
      "text": "When a new Transaction is created, append its txn_hash into the investor's session buffer, implementing FIFO ring buffer behavior where if the buffer already has 6 hashes, remove the oldest and then add the new one",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-5"
        ],
        "quotes": [
          "When a new Transaction is created, append its txn_hash into this buffer",
          "If the buffer already has 6 hashes, remove the oldest and then add the new one (FIFO ring buffer)"
        ]
      },
      "acceptanceCriteria": [
        "New transaction hashes are appended to the buffer automatically",
        "When buffer reaches 6 items, oldest hash is removed before adding new one",
        "FIFO ordering is maintained (oldest to newest)"
      ]
    },
    {
      "id": "REQ-3",
      "text": "Add a read-only backend endpoint that returns the current list of up to 6 transaction hashes for the logged-in investor, ordered from oldest to newest",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-5"
        ],
        "quotes": [
          "Add a read-only endpoint or API that returns the current list of up to 6 hashes for the logged-in investor, in order from oldest to newest"
        ]
      },
      "acceptanceCriteria": [
        "Endpoint returns array of txn_hash values for the caller's session",
        "Hashes are ordered from oldest to newest",
        "Endpoint is read-only and does not modify state",
        "Returns up to 6 hashes (may be fewer if session has fewer transactions)"
      ]
    },
    {
      "id": "REQ-4",
      "text": "Display the code or logic added for the session buffer and read-only endpoint in the implementation",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-5"
        ],
        "quotes": [
          "Show me the code or logic you added for the buffer and this read-only endpoint"
        ]
      },
      "acceptanceCriteria": [
        "Buffer implementation code is visible in backend/main.mo",
        "Read-only endpoint implementation code is visible in backend/main.mo",
        "FIFO ring buffer logic is clearly implemented"
      ]
    }
  ],
  "constraints": [
    "Keep all existing models and logic exactly as they are",
    "Buffer must store exactly 6 txn_hash values maximum",
    "Buffer must be scoped per investor session, not global",
    "FIFO ring buffer behavior must be implemented correctly"
  ],
  "nonGoals": [
    "Modifying existing transaction creation logic beyond adding buffer append",
    "Changing existing data models or schema",
    "Persisting the buffer across canister upgrades",
    "Adding frontend UI for displaying the buffer"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}